"use strict";(self.webpackChunkdocusaurus_template_openapi_docs=self.webpackChunkdocusaurus_template_openapi_docs||[]).push([[30],{28453:(e,t,r)=>{r.d(t,{R:()=>l,x:()=>o});var i=r(96540);const n={},s=i.createContext(n);function l(e){const t=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),i.createElement(s.Provider,{value:t},e.children)}},51556:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"distributions/self-hosted-distro/dell-tgi","title":"Dell-TGI Distribution","description":"Dell\'s custom TGI inference container distribution for self-hosted Llama Stack deployment","source":"@site/docs/distributions/self-hosted-distro/dell-tgi.mdx","sourceDirName":"distributions/self-hosted-distro","slug":"/distributions/self-hosted-distro/dell-tgi","permalink":"/llama-stack/docs/distributions/self-hosted-distro/dell-tgi","draft":false,"unlisted":false,"editUrl":"https://github.com/meta-llama/llama-stack/tree/main/docs/docs/distributions/self-hosted-distro/dell-tgi.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Dell-TGI Distribution","description":"Dell\'s custom TGI inference container distribution for self-hosted Llama Stack deployment","sidebar_label":"Dell-TGI","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Dell","permalink":"/llama-stack/docs/distributions/self-hosted-distro/dell"},"next":{"title":"Meta Reference GPU","permalink":"/llama-stack/docs/distributions/self-hosted-distro/meta-reference-gpu"}}');var n=r(74848),s=r(28453);const l={title:"Dell-TGI Distribution",description:"Dell's custom TGI inference container distribution for self-hosted Llama Stack deployment",sidebar_label:"Dell-TGI",sidebar_position:1},o="Dell-TGI Distribution",d={},a=[{value:"Provider Configuration",id:"provider-configuration",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Start the Distribution (Single Node GPU)",id:"start-the-distribution-single-node-gpu",level:3},{value:"Alternative: Dell-TGI server + llama stack run (Single Node GPU)",id:"alternative-dell-tgi-server--llama-stack-run-single-node-gpu",level:3},{value:"Start Dell-TGI server locally",id:"start-dell-tgi-server-locally",level:4},{value:"Start Llama Stack server pointing to TGI server",id:"start-llama-stack-server-pointing-to-tgi-server",level:4},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Related Guides",id:"related-guides",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"dell-tgi-distribution",children:"Dell-TGI Distribution"})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"llamastack/distribution-tgi"})," distribution consists of the following provider configurations."]}),"\n",(0,n.jsx)(t.h2,{id:"provider-configuration",children:"Provider Configuration"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"API"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Inference"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Agents"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Memory"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Safety"})}),(0,n.jsx)(t.th,{children:(0,n.jsx)(t.strong,{children:"Telemetry"})})]})}),(0,n.jsx)(t.tbody,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"Provider(s)"})}),(0,n.jsx)(t.td,{children:"remote::tgi"}),(0,n.jsx)(t.td,{children:"meta-reference"}),(0,n.jsx)(t.td,{children:"meta-reference, remote::pgvector, remote::chroma"}),(0,n.jsx)(t.td,{children:"meta-reference"}),(0,n.jsx)(t.td,{children:"meta-reference"})]})})]}),"\n",(0,n.jsxs)(t.p,{children:["The only difference vs. the ",(0,n.jsx)(t.code,{children:"tgi"})," distribution is that it runs the Dell-TGI server for inference."]}),"\n",(0,n.jsx)(t.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,n.jsx)(t.h3,{id:"start-the-distribution-single-node-gpu",children:"Start the Distribution (Single Node GPU)"}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsx)(t.p,{children:"This assumes you have access to GPU to start a TGI server with access to your GPU."})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"$ cd distributions/dell-tgi/\n$ ls\ncompose.yaml  README.md  run.yaml\n$ docker compose up\n"})}),"\n",(0,n.jsx)(t.p,{children:"The script will first start up TGI server, then start up Llama Stack distribution server hooking up to the remote TGI provider for inference. You should be able to see the following outputs:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"[text-generation-inference] | 2024-10-15T18:56:33.810397Z  INFO text_generation_router::server: router/src/server.rs:1813: Using config Some(Llama)\n[text-generation-inference] | 2024-10-15T18:56:33.810448Z  WARN text_generation_router::server: router/src/server.rs:1960: Invalid hostname, defaulting to 0.0.0.0\n[text-generation-inference] | 2024-10-15T18:56:33.864143Z  INFO text_generation_router::server: router/src/server.rs:2353: Connected\nINFO:     Started server process [1]\nINFO:     Waiting for application startup.\nINFO:     Application startup complete.\nINFO:     Uvicorn running on http://[::]:8321 (Press CTRL+C to quit)\n"})}),"\n",(0,n.jsx)(t.p,{children:"To kill the server:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"docker compose down\n"})}),"\n",(0,n.jsx)(t.h3,{id:"alternative-dell-tgi-server--llama-stack-run-single-node-gpu",children:"Alternative: Dell-TGI server + llama stack run (Single Node GPU)"}),"\n",(0,n.jsx)(t.h4,{id:"start-dell-tgi-server-locally",children:"Start Dell-TGI server locally"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"docker run -it --pull always --shm-size 1g -p 80:80 --gpus 4 \\\n-e NUM_SHARD=4\n-e MAX_BATCH_PREFILL_TOKENS=32768 \\\n-e MAX_INPUT_TOKENS=8000 \\\n-e MAX_TOTAL_TOKENS=8192 \\\nregistry.dell.huggingface.co/enterprise-dell-inference-meta-llama-meta-llama-3.1-8b-instruct\n"})}),"\n",(0,n.jsx)(t.h4,{id:"start-llama-stack-server-pointing-to-tgi-server",children:"Start Llama Stack server pointing to TGI server"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"docker run --pull always --network host -it -p 8321:8321 -v ./run.yaml:/root/my-run.yaml --gpus=all llamastack/distribution-tgi --yaml_config /root/my-run.yaml\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Make sure in you ",(0,n.jsx)(t.code,{children:"run.yaml"})," file, you inference provider is pointing to the correct TGI server endpoint. E.g."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"inference:\n  - provider_id: tgi0\n    provider_type: remote::tgi\n    config:\n      url: http://127.0.0.1:5009\n"})}),"\n",(0,n.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Hardware"}),": GPU access required"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Software"}),": Docker with GPU support"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Models"}),": Dell enterprise TGI container images"]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,n.jsx)(t.p,{children:"The Dell-TGI distribution is ideal for:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Enterprise deployments with Dell infrastructure"}),"\n",(0,n.jsx)(t.li,{children:"High-performance inference with custom TGI optimizations"}),"\n",(0,n.jsx)(t.li,{children:"Self-hosted environments requiring enterprise support"}),"\n",(0,n.jsx)(t.li,{children:"Production workloads with specific performance requirements"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"related-guides",children:"Related Guides"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.a,{href:"./dell",children:"Dell Distribution"})})," - Dell's standard distribution"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.a,{href:"../configuration",children:"Configuration Reference"})})," - Understanding configuration options"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:(0,n.jsx)(t.a,{href:"../building-distro",children:"Building Custom Distributions"})})," - Create your own distribution"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}}}]);